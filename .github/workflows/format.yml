name: "Code Formatters"
on:
  pull_request:
    branches:
      - master
    paths:
      - "**.yml"
      - "**.yaml"
      - "**.js"
      - "**.ts"
      - "**.json"
      - "**.md"
permissions:
  contents: read
  pull-requests: read
jobs:
  changes:
    runs-on: ubuntu-latest
    outputs:
      yaml: ${{ steps.changes.outputs.yaml }}
      prettier: ${{ steps.changes.outputs.prettier }}
      markdown: ${{ steps.changes.outputs.markdown }}
      actions: ${{ steps.changes.outputs.actions }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
      - uses: dorny/paths-filter@v3
        id: changes
        with:
          filters: |
            yaml:
              - '**/*.yml'
              - '**/*.yaml'
            actions:
              - '**/.github/workflows/**'
            prettier:
              - '**/*.js'
              - '**/*.ts'
              - '**/*.json'
              - '**/*.md'
            markdown:
              - '**/*.md'
  yamllint:
    runs-on: ubuntu-latest
    needs: changes
    if: ${{ needs.changes.outputs.yaml == 'true' }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
      - name: "Yamllint"
        uses: karancode/yamllint-github-action@master
        with:
          yamllint_strict: false
          yamllint_comment: true
        env:
          GITHUB_ACCESS_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  prettier:
    runs-on: ubuntu-latest
    needs: changes
    if: ${{ needs.changes.outputs.prettier == 'true' }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
      - name: Prettify code
        uses: creyD/prettier_action@v4.6
        with:
          dry: True
          prettier_options: "--check ."
  markdownlint:
    runs-on: ubuntu-latest
    needs: changes
    if: ${{ needs.changes.outputs.markdown == 'true' }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
      - name: Install markdownlint-cli
        run: |
          npm install -g markdownlint-cli
      - name: Run markdownlint
        run: |
          markdownlint '**/*.md'
  actoinlint:
    runs-on: ubuntu-latest
    needs: changes
    if: ${{ needs.changes.outputs.actions == 'true' }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
      - name: actionlint
        uses: raven-actions/actionlint@v2
